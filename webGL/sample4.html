
<html>

<head>
<title>Learning WebGL &mdash; lesson 3</title>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">

<script type="text/javascript" src="glMatrix-0.9.5.min.js"></script>
<script type="text/javascript" src="webgl-utils.js"></script>

<!-- Shaderのコード-->
<script id="shader-fs" type="x-shader/x-fragment">
    /* floatの精度を指定 */
    precision mediump float;
  
    /* ■sample2.htmlから追加■:varying変数としての出力 */
    varying vec4 vColor;

    void main(void) {
        gl_FragColor = vColor;
    }
    
</script>

<script id="shader-vs" type="x-shader/x-vertex">
    attribute vec3 aVertexPosition;

    /* ■sample2.htmlから追加■:頂点ごとに異なる入力を持たせる */
    attribute vec4 aVertexColor; 

    /* Uniform変数 :shaderの外部からアクセス可能 */
    uniform mat4 uMVMatrix;
    uniform mat4 uPMatrix;
    uniform float pointSize;

    /* ■sample2.htmlから追加■:varying変数としての出力 */
    varying vec4 vColor;
    
    void main(void) {
	/* model-view matrix とprojection matrixを掛けたものを最終的な頂点座標として出力 */
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
        gl_PointSize = pointSize;
	/* ■sample2.htmlから追加■:varying変数としての出力 */
	vColor = aVertexColor;
    }
</script>


<script type="text/javascript">
    var gl;
    function initGL(canvas) {
        try {
	    // gl => WebGLの中心となるコンテキストの取得
            gl = canvas.getContext('webgl') || canvas.getContext("experimental-webgl");
	    // Javascriptのオブジェクトにはどんなプロパティも追加できる特徴があり，
	    // viewportWidthとviewportHeightを新たに追加
	    gl.viewportWidth = canvas.width;
            gl.viewportHeight = canvas.height;
        } catch (e) {
        }
        if (!gl) {
            alert("Could not initialise WebGL, sorry :-(");
        }
    }

    // フラグメントシェーダ var fragmentShader = getShader(gl, "shader-fs");
    // バーテックスシェーダ var vertexShader = getShader(gl, "shader-vs");
    // シェーダを生成する関数
    function getShader(gl, id) {
        // HTMLからscriptタグへの参照を取得
	var shaderScript = document.getElementById(id);
        if (!shaderScript) {
            return null;
        }

        var str = "";
        var k = shaderScript.firstChild;
        while (k) {
            if (k.nodeType == 3) {
                str += k.textContent;
            }
            k = k.nextSibling;
        }

        var shader;
        if (shaderScript.type == "x-shader/x-fragment") {
            shader = gl.createShader(gl.FRAGMENT_SHADER);
        } else if (shaderScript.type == "x-shader/x-vertex") {
            shader = gl.createShader(gl.VERTEX_SHADER);
        } else {
            return null;
        }

	// 生成されたシェーダにソースを割り当てる
        gl.shaderSource(shader, str);
	// シェーダをコンパイルする
        gl.compileShader(shader);

        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
            alert(gl.getShaderInfoLog(shader));
            return null;
        }

        return shader;
    }


    var shaderProgram;

    function initShaders() {
        var fragmentShader = getShader(gl, "shader-fs");
        var vertexShader = getShader(gl, "shader-vs");

        shaderProgram = gl.createProgram();
        gl.attachShader(shaderProgram, vertexShader);
        gl.attachShader(shaderProgram, fragmentShader);
        gl.linkProgram(shaderProgram);

        if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
            alert("Could not initialise shaders");
        }

        gl.useProgram(shaderProgram);

        shaderProgram.vertexPositionAttribute = gl.getAttribLocation(shaderProgram, "aVertexPosition");
        gl.enableVertexAttribArray(shaderProgram.vertexPositionAttribute);
	
	// ■sample2.htmlから追加■:色のattributeを取得し，vertic shaderに渡す
	shaderProgram.vertexColorAttribute = gl.getAttribLocation(shaderProgram, "aVertexColor");
        gl.enableVertexAttribArray(shaderProgram.vertexColorAttribute);

        shaderProgram.pMatrixUniform = gl.getUniformLocation(shaderProgram, "uPMatrix");
        shaderProgram.mvMatrixUniform = gl.getUniformLocation(shaderProgram, "uMVMatrix");
	
	
    }


    var mvMatrix = mat4.create();

    // ■sample3.htmlから追加■:　Stackさせるための一時変数
    var mvMatrixStack = [];

    var pMatrix = mat4.create();

    // ■sample3.htmlから追加（ここから)■: 現在のmvMatrixのデータをmvMatrixStackにコピーする
    function mvPushMatrix() {
        var copy = mat4.create();
        mat4.set(mvMatrix, copy);
        mvMatrixStack.push(copy);
    }

    function mvPopMatrix() {
        if (mvMatrixStack.length == 0) {
            throw "Invalid popMatrix!";
        }
        mvMatrix = mvMatrixStack.pop();
    }
    // ■sample3.htmlから追加（ここまで)■:

    // initShader関数で取得したprojection matrixとmodel-view matrixを表すuniform変数への参照を利用して
    // WebGLにJavaScript形式のmatrixを渡します。
    function setMatrixUniforms() {
        gl.uniformMatrix4fv(shaderProgram.pMatrixUniform, false, pMatrix);
        gl.uniformMatrix4fv(shaderProgram.mvMatrixUniform, false, mvMatrix);
    }

    // ■sample3.htmlから追加■:　degreeをradianに変換
    function degToRad(degrees) {
        return degrees * Math.PI / 180;
    }

    // bufferを保存するための２つのグローバル変数を定義する。
    // シーン中のobject毎に異なるグローバル変数を使うべきではない。
    var triangleVertexPositionBuffer;
    var waveVertexPositionBuffer;
    
    // ■sample2.htmlから追加■:　色バッファを格納するグローバル変数を定義
    var triangleVertexColorBuffer;
    var waveVertexColorBuffer;
    
    // マーカーのサイズ
    var pointSize = Number(5);

    function initBuffers(data) {
        triangleVertexPositionBuffer = gl.createBuffer();
        // WebGLに以降のbufferに対する操作は全てこの引数として指定したbufferに対して行うように伝える。
	// この操作時に対象のbufferを指定するのではなく、あらかじめ"current array buffer"を指定→操作の実行が必須。
	
	gl.bindBuffer(gl.ARRAY_BUFFER, triangleVertexPositionBuffer);
 	
	// 変数vertex:図形の3D空間での座標
	var grid = new Array();
	// X軸
	grid.push(-30,0,0,30,0,0);
	// Y軸
	grid.push(0,-10,0,0,10,0);
	// X軸目盛
	for(var i=0;i<121;i++){
	grid.push(-30+0.5*i,-0.2,0,-30+0.5*i,0.2,0);
	}
	var vertices = grid;
	
	// JavaScriptの配列をもとにFloat32Array objectを作ってWebGLに"Current Buffer"にこの値を設定する
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);

        // bufferに対する最後の操作は２つの新しいプロパティを追加する事です。(WebGLの組み込み機能ではないが、後ほど役に立つ）
	// JavaScriptの素晴らしい点（悪い点という人もいるかも）の１つに、objectに個々のプロパティを設定するのに、明示的に宣言しておく必要がない、というのがあります。
	// buffer objectにはitemSizeとnumItemsプロパティはありませんでしたが、これでプロパティを持つようになりました。
	// このプロパティで9要素からなるbufferが３つの頂点(numItems)を持ち、それぞれは３つの数値(itemSize)から成り立つことを表せます。
	triangleVertexPositionBuffer.itemSize = 3;
        triangleVertexPositionBuffer.numItems = 240;

	triangleVertexColorBuffer = gl.createBuffer();
	gl.bindBuffer(gl.ARRAY_BUFFER, triangleVertexColorBuffer);
	var colors = new Array();
	for(i = 0; i<240;i++){
	colors.push(1.0,1.0,1.0,1.0);
	}
	gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors),gl.STATIC_DRAW);
	triangleVertexColorBuffer.itemSize = 4;
	triangleVertexColorBuffer.numItems = 240;

	// **********************************************
	// 時刻歴波形データ
	waveVertexPositionBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, waveVertexPositionBuffer);
	// 
	wave_vertices = new Array();
	for(var i=0;i<601;i++){
	wave_vertices.push(-30+0.1*i,2*data[i],0);
	}
	gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(wave_vertices),gl.DYNAMIC_DRAW);
	waveVertexPositionBuffer.itemSize = 3;
	waveVertexPositionBuffer.numItems = 600;

	// 色情報
	waveVertexColorBuffer = gl.createBuffer();
	gl.bindBuffer(gl.ARRAY_BUFFER, waveVertexColorBuffer);
	var colors = new Array();
	for(i = 0; i<601;i++){
	colors.push(1.0-1/600*i,1/600*i,0.0,1.0);
	}
	gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(colors),gl.STATIC_DRAW);
	waveVertexColorBuffer.itemSize = 4;
	waveVertexColorBuffer.numItems = 600;

	// ***********************************************
    }

    // ■sample3.htmlから追加■ 回転を与える変数
    var rTri = 0;
    var rdata = new Array();
    // 描画を行うための関数
    function drawScene() {
	// viewport関数: WebGLにcanvasの大きさを伝える
        gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight);
	
	// 描画の準備としてcanvasを消去
        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);

	// ここでシーンをどのように見せたいかの設定とともにperspectiveを設定します。
	// ここでの設定：シーンの（垂直）視野角として45度、canvasの幅と高さの比、視点にこれより近づいたら表示しない距離として0.1、これ以上離れたら表示しないという距離として100
	// このperspective関数は非常に便利ですがWebGLに組み込まれていないため、そこでユーティリティ関数としてプログラムの上の方で定義しています。
        mat4.perspective(45, gl.viewportWidth / gl.viewportHeight, 0.1, 100.0, pMatrix);

        mat4.identity(mvMatrix);
	
	// 座標位置の移動（カメラのアングル？）
        mat4.translate(mvMatrix, [0.0, 0.0, -15.0]);

	// ■sample3.htmlから追加■ 
	mvPushMatrix();
	mat4.rotate(mvMatrix,degToRad(rTri),[0, 1, 0]);

        gl.bindBuffer(gl.ARRAY_BUFFER, triangleVertexPositionBuffer);
        gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute, triangleVertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);

	gl.bindBuffer(gl.ARRAY_BUFFER,triangleVertexColorBuffer);
	gl.vertexAttribPointer(shaderProgram.vertexColorAttribute,triangleVertexColorBuffer.itemSize,gl.FLOAT, false, 0,0);
	
	// これはWebGLにcurrentのmodel-view matrix(それとprojection matrixもだけど、それはまた後で)を利用するように伝えます。
	// model-view matrixをグラフィックカードに送る
        setMatrixUniforms();
	
	// uniformLocationを配列に取得
	var uniLocation = new Array();
	uniLocation[0]  = gl.getUniformLocation(shaderProgram, 'uMVMatrix');
	uniLocation[1]  = gl.getUniformLocation(shaderProgram, 'pointSize');
	
	// ここまでの処理が終わると、WebGLは頂点として扱われるべき座標の配列とmatrixを持っています。
	// ここでの処理イメージ ⇒ 先ほど渡した頂点配列で三角形を描画しなさい。頂点は配列の０番の要素からnumItems番目の要素まで使いなさい
	// 第１引数をプリミティブタイプという。
	// プリミティブタイプの種類: POINTS	 ⇒1つの頂点を１つの点として描画
	// プリミティブタイプの種類: LINES	 ⇒頂点を順に結んでいくが，直線は連続しない
	// プリミティブタイプの種類: LINE_STRIP  ⇒頂点を順に結んでいき，直線が連続する
	// プリミティブタイプの種類: LINE_LOOP   ⇒頂点を順に結んでいき，開始と終端の頂点も結ばれる。

	gl.uniform1f(uniLocation[1], pointSize);

        //gl.drawArrays(gl.POINTS, 0, triangleVertexPositionBuffer.numItems);
        gl.drawArrays(gl.LINES, 0, triangleVertexPositionBuffer.numItems);
        mvPopMatrix();

	// *****************************************************
	// 波形を描画
	// 時刻歴波形データ
	
	mvPushMatrix();
		// 波形データの頂点座標を更新
	　　    var r_signal   = document.getElementById("raw_data").value;
	        r_signal       = r_signal.split(",");
 	        var r_num_data = r_signal.length;
	        var r_data     = new Float32Array(r_num_data);
		var j          = count
	        for(var i = 0; j < r_signal.length; i++){
	   	r_data[i] = parseFloat(r_signal[j]);
		j++;
	        }
		waveVertexPositionBuffer = gl.createBuffer();
	        gl.bindBuffer(gl.ARRAY_BUFFER, waveVertexPositionBuffer);
		r_wave_vertices = new Array();
		for(i=0;i<601;i++){
			if(r_data[i]){
				r_wave_vertices.push(-30+0.1*i,2*r_data[i],0);
			}
			else{
				r_wave_vertices.push(-30+0.1*i,0.0,0);
			}
		}
		gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(r_wave_vertices),gl.DYNAMIC_DRAW);
		waveVertexPositionBuffer.itemSize = 3;
		waveVertexPositionBuffer.numItems = 600;
		    
	gl.bindBuffer(gl.ARRAY_BUFFER, waveVertexPositionBuffer);
        gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute, waveVertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);
	gl.bindBuffer(gl.ARRAY_BUFFER, waveVertexColorBuffer);
        gl.vertexAttribPointer(shaderProgram.vertexColorAttribute, waveVertexColorBuffer.itemSize, gl.FLOAT, false, 0, 0);
	//gl.drawArrays(gl.POINTS, 0, waveVertexPositionBuffer.numItems);
        gl.drawArrays(gl.LINE_STRIP, 0, waveVertexPositionBuffer.numItems);
        mvPopMatrix();
	// *****************************************************

    }

    
    // アニメーションの為の変数制御（角度の時間変化）
    var lastTime = 0;
    function animate() {
        var timeNow = new Date().getTime();
        if (lastTime != 0) {
            var elapsed = timeNow - lastTime;
	    var vel = document.getElementById('vel').value
            rTri += (90 * elapsed) / Number(vel);
        }
        lastTime = timeNow;
    }

    // 波形アニメーションの為の制御変数
    var count = 0;
    function animate_count(){
	count = count + 1;
    }

    function tick() {
	if(tick.animate){
	        requestAnimFrame(tick);
	        drawScene();
	        if(animate.on){
		animate();		// 回転アニメーションの制御パラメタ
		}
	        animate_count();	// 波形アニメーションの制御パラメタ
	}
    }
    // ■sample3.htmlから追加(ここまで)■

    
    // ※webGLを開始する関数（描画開始からまずはじめに実行される関数）
    function webGLStart() {	    
    	    var count = 0;
	    var signal   = document.getElementById("raw_data").value;
	    signal       = signal.split(",");
 	    var num_data = signal.length;
	    var data 	 = new Float32Array(num_data);
	    for(var i = 0; i < signal.length; i++){
		data[i] = parseFloat(signal[i]);
	    }
	    var canvas = document.getElementById("lesson03-canvas"); 	// 3Dの描画先となるcanvas element
	    initGL(canvas);
	    initShaders();
	    initBuffers(data);							// Bufferの初期化
	    
	    gl.clearColor(0.0, 0.0, 0.0, 1.0);
	    gl.enable(gl.DEPTH_TEST);
	    	    
	    var rotate_on_radio = document.getElementsByName("rotate_on");
	    for(var i = 0; i < rotate_on_radio.length; i++){
	    	if (rotate_on_radio[i].checked) {
			if(rotate_on_radio[i].value == '1'){
				animate.on = false;
			}
			else{
				animate.on = true;
			}
		}
	    }

	    tick.animate = true;
	    tick();
    }

    // 描画の停止ボタン
    function webGLStop(){
    	tick.animate = false;
    }


</script>


</head>


<body onload="();">

    <h3>データ</h3>
    時刻歴データをカンマ区切りで入力してください<br>
    ※デフォルトではEl Centro NS (1940)のデータが挿入されています<br>
    <!-- <textarea id="raw_data" style="width:300px;height:100px;">ここにカンマ区切りのデータを貼り付けてください</textarea> -->
    <textarea id="raw_data" style="width:300px;height:100px;">-0.014,-0.108,-0.101,-0.088,-0.095,-0.12,-0.142,-0.128,-0.11,-0.085,-0.085,-0.131,-0.176,-0.194,-0.162,-0.144,-0.108,-0.082,-0.042,-0.066,-0.131,-0.19,-0.196,-0.066,0.03,0.141,-0.049,-0.128,-0.144,-0.203,-0.26,-0.325,-0.306,-0.172,-0.197,-0.163,-0.164,-0.067,0.025,0.15,0.236,0.252,0.336,0.463,0.492,0.419,0.359,0.271,0.235,0.339,0.412,0.53,0.639,0.732,0.652,0.599,0.4,0.4,0.063,-0.515,-0.787,-0.603,-0.484,-0.25,-0.059,0.134,0.308,0.499,0.71,0.995,1.219,1.529,1.449,1.155,0.935,0.892,0.926,0.839,0.901,0.993,1.209,0.328,-1.475,-2.066,-1.989,-2.034,-1.816,-1.725,-1.752,-1.753,-1.805,-1.63,-1.347,-1.087,-0.782,-0.429,-0.017,0.36,0.785,1.164,1.598,1.96,2.412,2.729,3.036,3.2,3.417,2.821,2.324,-1.198,-2.373,-1.64,-1.865,-1.095,-0.753,-0.173,0.113,0.533,0.895,1.186,1.757,0.576,-2.631,-1.547,-1.729,-1.012,-0.579,0.237,-0.67,-1.98,-1.641,-1.685,-1.481,-1.231,-1.001,-0.751,-0.523,-0.271,-0.044,0.188,-0.095,-0.433,-0.838,-0.951,-0.716,-0.599,-0.334,-0.108,0.185,0.42,0.673,-0.097,-0.372,-0.04,0.011,0.344,0.565,0.883,1.13,1.363,0.219,0.241,0.683,0.689,1.318,1.353,2.04,-0.931,-1.308,-0.692,-0.546,0.072,0.675,-1.067,-1.488,-1.071,-1.162,-0.762,-0.559,-0.215,-0.126,-0.674,-0.324,-0.337,-0.109,0.017,0.299,0.488,0.608,0.222,-0.032,-0.245,0.077,0.211,0.568,0.826,1.206,1.478,1.737,0.421,0.029,0.259,0.293,-0.055,-0.147,0.143,0.206,0.499,0.645,0.957,1.128,1.447,1.629,1.945,1.856,1.984,1.769,1.25,-1.207,-0.542,-0.384,-0.311,-1.118,-1.661,-2.464,-2.025,-1.835,-1.317,-0.96,-0.325,0.154,0.816,1.319,1.818,-0.058,-0.169,0.285,0.447,0.983,1.424,1.853,2.456,1.685,-1.38,-0.999,-1.089,-0.907,-0.469,-1.25,-2.111,-1.617,-1.692,-1.306,-1.111,-0.773,-0.51,-0.544,-1.2,-1.209,-1.158,-1.145,-0.717,-0.546,0.064,-0.804,-1.634,-0.859,-0.961,-0.396,-0.147,0.319,0.648,0.876,0.472,0.198,-0.027,0.292,0.445,0.785,1.033,1.352,1.606,1.861,1.281,0.64,0.204,0.314,0.373,0.496,0.235,-0.084,-0.168,-0.113,-0.229,-0.248,-0.157,-0.069,0.147,0.379,0.579,0.255,-0.041,-0.428,-0.133,0.095,0.23,-0.129,-0.05,0.08,0.21,0.38,0.51,0.157,-0.032,-0.111,0.005,0.076,0.035,-0.095,-0.036,-0.016,0.038,0.085,-0.056,-0.304,-0.421,-0.244,-0.236,-0.177,-0.129,-0.018,0.203,-0.108,-0.091,-0.034,-0.106,-0.111,-0.099,-0.002,0.073,0.235,0.355,0.705,0.779,0.184,-0.263,-0.124,-0.042,0.159,0.048,-0.219,-0.467,-0.428,-0.216,-0.043,0.159,0.32,0.419,0.123,-0.16,-0.204,-0.082,-0.206,-0.137,-0.055,0.053,0.134,0.266,0.232,0.079,-0.008,0.2,0.435,0.492,0.191,0.092,-0.022,-0.021,0.052,0.093,0.255,0.368,0.525,0.541,0.425,0.398,0.559,0.756,0.365,0.411,0.098,-0.204,-0.249,-0.405,-0.413,-0.471,-0.433,-0.458,-0.057,0.178,-0.208,-0.492,-0.53,-0.362,-0.405,-0.308,-0.316,-0.265,-0.265,-0.269,-0.345,-0.309,-0.217,-0.078,0.087,0.281,0.31,0.358,0.341,0.358,0.287,0.305,0.112,0.214,0.136,0.384,-0.861,-1.349,-1.342,-1.354,-1.193,-1.042,-0.829,-0.651,-0.444,-0.258,-0.06,-0.091,-0.182,-0.147,0.085,0.163,0.05,0.264,0.582,0.867,1.2,1.695,1.111,-1.1,-0.366,-0.445,-0.236,-0.96,-0.656,-0.597,-0.67,-0.552,-0.027,0.378,1.072,1.669,0.947,0.408,0.667,0.132,-0.095,-0.52,-0.827,-1.152,-1.15,-0.803,-0.369,0.029,0.545,1.178,1.61,-0.27,0.034,-0.056,0.02,0.146,0.537,0.798,-0.205,-0.59,-0.169,-0.175,-0.028,0.074,0.382,0.567,0.753,0.801,0.592,0.304,0.023,0.064,-0.406,-0.451,-0.079,0.168,0.567,0.093,-0.055,0.044,-0.123,-0.282,-0.437,-0.352,-0.255,-0.111,0.205,0.519,0.854,1.144,0.733,0.237,-0.368,-0.271,-0.217,-0.873,-0.973,-0.589,-0.336,0.077,0.259,0.508,0.361,0.081,-0.056,-0.209,-0.317,-0.238,-0.376,-0.55,-0.722,-0.803,-0.523,-0.34,-0.011,0.065,-0.037,-0.005,-0.168,-0.41,-0.08,0.079,0.374,0.615,0.665,0.254,-0.057,-0.474,-0.356,-0.243,-0.048,0.126,0.379,0.241,-0.227,-0.428,-0.679,-0.661,-0.59,-0.513,-0.408,-0.309,-0.266,-0.541,-0.628,-0.908,-1.107,-0.881,-0.77,-0.582,-0.473,-0.333,-0.199,0.02,0.211,0.432,0.613,0.767,0.933,1.066,1.13,1.187,1.247,1.334,1.594,1.797,2.037,1.236,0.442,-0.14,-0.666,-0.555,-0.693,-0.984,-1.246,-1.179,-1.05,-0.92,-0.743,-0.809,-0.85,-0.86,-0.863,-0.873,-0.868,-0.885,-0.537,0.052,0.215,0.245,0.58,0.314,0.236,0.485,0.589,0.525,0.355,0.197,0.199,0.492,0.343,0.288,0.432,0.239,0.088,0.077,-0.148,-0.077,-0.019,0.075,0.044,-0.145,-0.316,-0.241,-0.028,0.182,0.426,0.439,0.512,0.466,0.479,0.193,0.222,0.274,0.393,0.504,0.577,0.588,0.822,0.797,0.949,0.345,0.045,-0.123,-0.347,-0.426,-0.416,-0.275,-0.27,0.074,0.428,-0.231,-0.387,-0.083,0.139,0.445,0.027,-0.697,-0.796,-0.251,-0.135,0.079,-0.115,-0.251,-0.333,-0.269,-0.301,-0.2,-0.067,-0.038,0.105,0.296,0.344,0.957,0.898,0.179,-0.362,-0.994,-0.807,-0.744,-0.539,-0.33,-0.128,0.031,0.148,0.508,-0.022,-0.489,-0.358,-0.691,-0.516,-0.371,0.088,0.632,0.841,1.276,1.388,1.193,0.751,0.225,-0.088,-0.227,0.074,0.181,0.544,0.399,0.045,-0.082,-0.185,-0.02,0.006,-0.117,-0.21,-0.303,-0.512,-0.727,-0.579,-0.266,-0.178,0.04,0.098,0.137,0.221,0.437,0.091,-0.548,-0.555,-0.243,-0.081,0.25,0.41,0.182,-0.027,-0.243,-0.015,0.247,0.482,0.783,0.622,0.331,-0.014,-0.195,-0.247,-0.212,-0.11,0.05,0.241,-0.034,-0.216,-0.471,-0.363,-0.195,-0.018,0.17,-0.08,0.005,0.23,0.374,0.601,0.516,0.432,0.344,0.505,0.653,0.683,0.172,-0.17,-0.527,-0.664,-0.387,-0.222,-0.033,0.119,-0.128,-0.351,-0.514,-0.335,-0.218,-0.012,0.142,0.07,-0.063,-0.12,-0.322,-0.346,-0.091,0.073,0.309,0.472,0.603,0.576,0.33,-0.073,-0.777,-0.608,-0.438,-0.209,0.031,0.35,0.293,0.121,0.338,0.317,0.254,0.206,0.198,0.174,0.021,-0.144,-0.343,-0.339,-0.145,-0.028,0.17,-0.096,-0.255,-0.279,-0.388,-0.242,-0.215,-0.182,-0.174,-0.038,-0.027,-0.185,-0.123,0.087,0.343,0.695,0.91,0.853,0.76,0.513,0.186,0.015,-0.19,-0.151,-0.073,0.021,0.129,0.215,0.024,-0.124,-0.329,-0.519,-0.708,-0.579,-0.462,-0.307,-0.145,-0.009,-0.18,-0.318,-0.465,-0.391,-0.345,-0.316,-0.435,-0.491,-0.475,-0.42,-0.361,-0.277,-0.258,-0.139,-0.068,0.507,0.722,0.878,0.782,0.765,0.439,0.08,0.013,-0.126,-0.015,0.03,0.104,0.104,0.193,0.205,0.074,-0.056,-0.072,0.07,0.106,0.147,-0.009,-0.159,-0.187,-0.007,0.155,0.105,-0.115,-0.302,-0.309,-0.095,-0.058,0.004,0.02,0.05,0.057,0.097,0.134,0.177,0.218,0.261,0.302,0.346,0.386,0.474,0.393,0.238,0.115,-0.079,-0.124,0.054,0.027,-0.25,-0.566,-0.63,-0.591,-0.413,-0.068,0.272,0.277,-0.021,-0.06,-0.11,-0.221,-0.416,-0.519,-0.222,0.03,0.079,0.139,0.171,0.253,0.323,0.391,0.164,-0.136,-0.323,-0.291,-0.287,-0.304,-0.339,-0.245,-0.076,0.125,0.376,0.402,0.245,0.156,-0.04,-0.153,-0.289,-0.316,-0.111,0.094,0.335,0.576,0.424,0.143,-0.007,-0.135,-0.27,-0.341,-0.357,-0.396,-0.402,-0.488,-0.48,-0.406,-0.407,-0.351,-0.187,-0.057,0.044,-0.019,-0.072,-0.169,-0.115,0.126,0.358,0.654,0.716,0.762,0.739,0.628,0.484,0.264,-0.044,-0.288,-0.384,-0.492,-0.428,-0.416,-0.276,-0.052,0.237,0.426,0.604,0.452,0.284,0.126,-0.054,-0.275,-0.423,-0.175,0.001,0.254,0.481,0.641,0.554,0.413,0.184,-0.048,-0.303,-0.531,-0.708,-0.928,-0.863,-0.631,-0.376,0.087,0.309,0.589,0.614,0.385,0.351,0.311,0.246,0.019,-0.198,-0.158,-0.015,0.099,0.286,0.408,0.563,0.531,0.314,0.165,-0.024,-0.189,-0.276,-0.371,-0.45,-0.534,-0.483,-0.379,-0.296,-0.196,-0.184,-0.159,-0.119,-0.053,0.002,0.059,-0.023,-0.112,-0.205,-0.322,-0.388,-0.341,-0.287,-0.328,-0.407,-0.487,-0.563,-0.644,-0.555,-0.446,-0.008,0.253,0.411,0.644,0.579,0.474,0.384,0.385,0.34,0.357,0.008,-0.254,-0.46,-0.471,-0.222,-0.065,0.164,0.355,0.504,0.371,0.28,0.158,0.041,-0.027,0.021,0.044,0.099,0.135,0.094,0.058,0.022,-0.031,-0.031,0.004,-0.025,-0.124,-0.235,-0.406,-0.53,-0.701,-0.323,-0.052,0.094,0.328,0.478,0.509,0.358,0.342,0.306,0.285,0.263,0.168,-0.005,-0.212,-0.365,-0.31,-0.297,-0.28,-0.237,-0.266,-0.308,-0.366,-0.357,-0.308,-0.193,0.019,0.196,0.16,0.129,0.14,0.11,0.108,0.092,0.089,0.019,-0.131,-0.247,-0.436,-0.432,-0.3,-0.192,-0.048,0.097,0.168,0.148,0.173,0.078,-0.058,-0.215,-0.234,0.06,0.262,0.269,0.084,-0.041,-0.227,-0.076,0.031,0.182,0.31,0.479,0.459,0.166,-0.058,-0.396,-0.444,-0.241,-0.101,0.217,0.261,0.121,0.008,-0.168,-0.382,-0.566,-0.781,-0.619,-0.256,0.044,0.456,0.783,1.103,0.953,0.489,0.122,-0.387,-0.846,-1.226,-0.864,-0.616,-0.228,0.15,0.477,0.323,0.248,0.095,0.227,0.338,0.505,0.594,0.519,0.552,0.595,0.617,0.593,0.466,0.158,-0.077,-0.23,-0.303,-0.329,-0.364,-0.49,-0.66,-0.723,-0.784,-0.846,-0.566,-0.209,0.128,0.381,0.488,0.363,0.25,0.158,0.377,0.594,0.63,0.37,0.217,0.04,0.023,-0.062,-0.286,-0.38,-0.457,-0.505,-0.777,-0.628,-0.189,0.189,0.509,0.744,0.749,0.562,0.455,0.525,0.635,0.731,0.851,0.927,0.975,0.929,0.814,0.264,-0.289,-0.901,-1.364,-0.859,-0.468,0.081,0.594,0.823,0.556,0.301,-0.011,-0.38,-0.347,-0.02,0.18,0.633,1.013,1.122,1.107,0.94,0.805,0.608,0.508,0.206,-0.201,-0.572,-1.021,-1.332,-1.225,-1.207,-1.006,-0.762,-0.548,-0.489,-0.405,-0.291,-0.176,-0.141,-0.098,-0.05,0.019,0.08,0.035,-0.029,-0.061,-0.034,-0.013,0.076,0.205,0.327,0.45,0.577,0.562,0.464,0.3,0.107,-0.004,-0.033,-0.069,-0.101,-0.201,-0.188,0.025,0.134,0.243,0.266,0.265,0.155,-0.019,-0.095,-0.216,-0.167,-0.12,-0.064,-0.129,-0.163,-0.193,-0.242,-0.236,-0.175,-0.124,-0.185,-0.265,-0.323,-0.336,-0.454,-0.43,-0.334,-0.213,-0.069,0.03,0.003,-0.093,-0.089,-0.15,-0.164,-0.238,-0.323,-0.421,-0.457,-0.397,-0.349,-0.258,-0.172,-0.02,0.156,0.284,0.362,0.354,0.269,0.101,-0.045,-0.125,-0.245,-0.229,-0.126,-0.068,0.018,0.093,0.2,0.286,0.365,0.311,0.181,0.024,-0.156,-0.319,-0.219,-0.118,0.015,0.153,0.298,0.243,0.136,0.102,0.024,-0.01,-0.023,-0.036,-0.048,-0.089,-0.155,-0.148,-0.076,0,-0.02,-0.148,-0.225,-0.374,-0.365,-0.251,-0.164,-0.014,0.153,0.302,0.393,0.406,0.385,0.329,0.183,0.125,0.07,-0.001,-0.068,-0.13,-0.128,-0.115,-0.102,-0.084,-0.141,-0.205,-0.269,-0.35,-0.359,-0.297,-0.227,0.018,0.099,0.203,0.256,0.199,0.16,0.107,0.156,0.198,0.242,0.141,0.055,-0.066,-0.097,-0.026,0.016,0.1,0.094,0.039,0,-0.066,-0.099,-0.109,-0.115,-0.131,-0.168,-0.199,-0.104,-0.01,0.055,0.129,0.2,0.199,0.169,0.143,0.109,0.128,0.152,0.137,0.117,0.097,0.06,-0.028,-0.05,-0.084,-0.178,-0.321,-0.42,-0.518,-0.472,-0.394,-0.29,-0.11,0.05,0.132,0.157,0.177,0.195,0.255,0.331,0.328,0.252,0.173,0.045,-0.085,-0.19,-0.229,-0.304,-0.277,-0.227,-0.174,-0.121,-0.126,-0.129,-0.08,-0.026,0.039,0.065,0.055,0.05,0.064,0.126,0.179,0.243,0.307,0.298,0.251,0.216,0.163,0.192,0.234,0.282,0.301,0.196,0.106,-0.039,-0.163,-0.322,-0.335,-0.219,-0.148,-0.01,0.011,-0.053,-0.101,-0.126,-0.143,-0.129,-0.104,-0.071,-0.018,0.033,0.085,0.158,0.239,0.319,0.341,0.318,0.213,0.073,0.009,-0.015,-0.047,-0.075,-0.121,-0.156,-0.116,-0.056,-0.006,-0.003,-0.003,0.014,0.046,0.072,0.086,0.098,0.124,0.147,0.172,0.2,0.256,0.317,0.287,0.231,0.105,-0.001,-0.011,-0.036,-0.053,-0.083,-0.052,-0.007,0.037,0.096,0.155,0.205,0.143,0.073,0.021,-0.022,-0.07,-0.1,-0.075,-0.054,-0.029,-0.015,0,-0.001,-0.006,-0.011,-0.01,-0.003,0.001,0.016,0.053,0.086,0.126,0.154,0.131,0.102,0.056,0.006,-0.04,-0.098,-0.096,-0.046,-0.007,0.031,0.045,0.068,0.052,0.045,0.018,-0.002,-0.029,-0.028,-0.017,-0.006,-0.005,-0.017,-0.022,-0.036,-0.032,-0.007,0.014,0.041,0.065,0.063,0.052,0.006,-0.045,-0.076,-0.064,-0.065,-0.107,-0.161,-0.174,-0.117,-0.07,-0.036,-0.025,-0.002,0.004,0.036,0.082,0.115,0.07,0.038,-0.01,-0.025,-0.034,-0.041,-0.045,-0.065,-0.12,-0.117,-0.108,-0.098,-0.081,-0.076,-0.11,-0.138,-0.166,-0.144,-0.13,-0.111,-0.108,-0.098,-0.098,-0.063,-0.002,0.054,0.11,0.152,0.197,0.17,0.14,0.103,0.064,0.01,-0.067,-0.105,-0.122,-0.138,-0.166,-0.215,-0.269,-0.274,-0.217,-0.178,-0.116,-0.061,0,0.054,0.099,0.144,0.187,0.232,0.262,0.255,0.227,0.171,0.127,0.054,-0.047,-0.149,-0.21,-0.254,-0.252,-0.245,-0.226,-0.179,-0.136,-0.082,-0.014,0.044,0.089,0.097,0.1,0.1,0.104,0.136,0.121,0.1,0.072,0.019,-0.028,-0.083,-0.131,-0.19,-0.194,-0.139,-0.1,-0.044,-0.044,-0.04,-0.045,-0.049,-0.039,-0.021,-0.022,-0.016,-0.016,-0.012,-0.012,0.028,0.068,0.115,0.096,0.056,0.017,-0.031,-0.078,-0.092,-0.092,-0.095,-0.092,-0.086,-0.052,-0.022,0.014,0.038,0.034,0.034,0.029,0.04,0.054,0.067,0.085,0.087,0.077,0.07,0.061,0.075,0.087,0.102,0.111,0.09,0.075,0.053,0.062,0.079,0.097,0.118,0.135,0.105,0.077,0.044,0.012,-0.021,-0.042,-0.068,-0.087,-0.12,-0.159,-0.198,-0.233,-0.258,-0.27,-0.278,-0.287,-0.278,-0.27,-0.258,-0.251,-0.219,-0.173,-0.129,-0.109,-0.105,-0.095,-0.091,-0.072,-0.059,-0.04,-0.023,0.018,0.035,0.042,0.048,0.043,0.043,0.038,0.036,0.032,0.047,0.063,0.085,0.11,0.134,0.16,0.181,0.173,0.168,0.159,0.147,0.108,0.068,0.032,0.009,0.019,0.028,0.04,0.054,0.069,0.095,0.117,0.143,0.143,0.125,0.122,0.124,0.126,0.13,0.133,0.106,0.079,0.046,0.02,0.005,-0.011,-0.025,-0.011,0.018,0.043,0.076,0.103,0.133,0.101,0.062,0.018,-0.027,-0.08,-0.089,-0.054,-0.03,0.006,0.012,0.022,0.027,0.032,0.048,0.069,0.089,0.112,0.133,0.14,0.137,0.14,0.135,0.139,0.102,0.03,-0.032,-0.063,-0.085,-0.112,-0.157,-0.197,-0.188,-0.182,-0.17,-0.156,-0.142,-0.129,-0.125,-0.12,-0.116,-0.114,-0.106,-0.064,-0.021,0.002,-0.004,-0.004,-0.014,-0.019,-0.008,0.011,0.027,0.05,0.053,0.042,0.03,0.011,-0.005,-0.024,-0.02,-0.007,0.004,0.019,0.033,0.048,0.057,0.065,0.074,0.081,0.091,0.127,0.169,0.144,0.105,0.07,0.035,0.002,-0.032,-0.064,-0.095,-0.091,-0.083,-0.073,-0.051,-0.03,-0.004,0.033,0.052,0.044,0.04,0.03,0.02,0.01,0.001,-0.01,-0.014,0.002,0.016,0.03,0.023,0.016,0.016,0.026,0.032,0.045,0.046,0.021,-0.003,-0.03,-0.06,-0.087,-0.116,-0.107,-0.094,-0.078,-0.068,-0.063,-0.057,-0.05,-0.041,-0.033,-0.024,-0.014,-0.005,0.004,0.013,0.021,0.001,-0.018,-0.04,-0.064,-0.087,-0.11,-0.129,-0.151,-0.165,-0.174,-0.184,-0.194,-0.202,-0.213,-0.198,-0.173,-0.135,-0.065,-0.014,0.02,0.055,0.082,0.089,0.102,0.093,0.08,0.061,0.033,0.003,-0.024,-0.057,-0.045,-0.013,0.013,0.033,0.048,0.054,0.058,0.062,0.065,0.069,0.072,0.075,0.077,0.073,0.069,0.064,0.058,0.054,0.048,0.061,0.079,0.096,0.114,0.126,0.139,0.131,0.123,0.114,0.103,0.087,0.072,0.056,0.04,0.024,0.007,0.004,0.008,0.009,0.023,0.042,0.052,0.061,0.072,0.079,0.089,0.095,0.095,0.093,0.089,0.025,0,-0.005,-0.02,-0.024,-0.033,-0.048,-0.064,-0.08,-0.097,-0.114,-0.128,-0.106,-0.089,-0.066,-0.043,-0.019,-0.011,-0.009,-0.005,-0.004,0.005,0.014,0.024,0.035,0.043,0.044,0.039,0.013,-0.008,-0.036,-0.047,-0.055,-0.062,-0.068,-0.073,-0.08,-0.075,-0.064,-0.028,0.005,0.046,0.065,0.06,0.06,0.054,0.049,0.044,0.039,0.029,0,-0.026,-0.052,-0.042,-0.037,-0.025,-0.015,-0.002,0.002,0,-0.001,-0.004,-0.007,-0.006,-0.001,0.003,0.007,-0.001,-0.007,-0.015,-0.024,-0.029,-0.028,-0.028,-0.025,-0.024,-0.021,-0.027,-0.044,-0.058,-0.076,-0.084,-0.082,-0.083,-0.075,-0.05,-0.028,-0.002,0.018,0.018,0.021,0.021,0.021,0.031,0.043,0.049,0.049,0.049,0.048,0.047,0.052,0.067,0.079,0.095,0.097,0.096,0.096,0.093,0.091,0.089,0.087,0.084,0.082,0.08,0.077,0.062,0.047,0.035,0.036,0.034,0.035,0.036,0.032,0.019,0.015,0.014,0.012,0.012,0.011,0,-0.01,-0.02,-0.025,-0.029,-0.033,-0.037,-0.048,-0.063,-0.077,-0.092,-0.107,-0.122,-0.138,-0.143,-0.12,-0.103,-0.078,-0.067,-0.063,-0.058,-0.056,-0.053,-0.05,-0.048,-0.045,-0.042,-0.039,-0.031,-0.026,-0.011,0.01,0.031,0.046,0.048,0.054,0.055,0.063,0.084,0.101,0.084,0.071,0.053,0.033,0.028,0.029,0.028,0.027,0.012,-0.001,-0.01,-0.011,-0.016,-0.015,-0.031,-0.068,-0.099,-0.102,-0.105,-0.106,-0.099,-0.089,-0.079,-0.074,-0.072,-0.068,-0.067,-0.063,-0.04,-0.013,0.013,0.043,0.071,0.099,0.086,0.063,0.041,0.013,-0.014,-0.035,-0.037,-0.044,-0.046,-0.049,-0.051,-0.054,-0.056,-0.058,-0.046,-0.029,-0.013,0.007,0.017,0.019,0.025,0.025,0.035,0.05,0.064,0.08,0.094,0.097,0.102,0.105,0.108,0.11,0.104,0.099,0.093,0.086,0.079,0.072,0.063,0.055,0.046,0.038,0.031,0.027,0.021,0.017,0.012,0.007,0.003,0.008,0.013,0.019,0.022,0.009,-0.003,-0.017,-0.031,-0.047,-0.053,-0.048,-0.043,-0.038,-0.025,-0.009,0.007,0.017,0.022,0.035,0.061,0.083,0.112,0.107,0.087,0.071,0.047,0.027,0.004,-0.016,-0.024,-0.033,-0.046,-0.069,-0.084,-0.088,-0.093,-0.095,-0.097,-0.099,-0.101,-0.102,-0.098,-0.095,-0.09,-0.087,-0.089,-0.091,-0.093,-0.096,-0.097,-0.088,-0.081,-0.071,-0.068,-0.068,-0.067,-0.067,-0.066,-0.066,-0.064,-0.056,-0.05,-0.043,-0.034,-0.023,-0.013,-0.002,0.01,0.017,0.009,0.003,-0.005,-0.014,-0.007,0.006,0.016,0.013,0.012,0.008,0.005,0,0.002,0.009,0.014,0.021,0.022,0.01,0,-0.012,-0.024,-0.024,-0.019,-0.016,-0.018,-0.022,-0.027,-0.03,-0.026,-0.022,-0.022,-0.032,-0.041,-0.051,-0.046,-0.043,-0.038,-0.032,-0.026,-0.02,-0.019,-0.018,-0.015,0.013,0.041,0.067,0.07,0.076,0.078,0.08,0.081,0.084,0.078,0.061,0.048,0.031,0.029,0.03,0.032,0.035,0.037,0.024,0.007,-0.008,-0.028,-0.035,-0.022,-0.013,0.001,0.003,0.001,-0.001,-0.005,-0.008,-0.011,-0.015,-0.012,-0.008,-0.004,0.001,0.005,0.008,0.008,0.009,0.01,0.022,0.033,0.046,0.059,0.072,0.079,0.062,0.05,0.032,0.016,-0.004,0,0.03,0.052,0.087,0.082,0.031,-0.002,-0.062,-0.028,0.058,0.13,0.221,0.185,0.094,0.091,0.077,0.09,0.016,-0.084,-0.2,-0.148,-0.007,0.107,0.099,0.048,0.003,-0.069,-0.107,-0.015,0.069,0.138,0.067,0.02,0.035,0.09,0.086,0.052,0.024,0.016,0.013,-0.011,-0.034,-0.067,-0.054,-0.02,0.014,0.048,0.097,0.058,-0.048,-0.119,-0.095,-0.06,-0.024,0.032,0.038,0.014,-0.001,-0.007,0.006,0.01,0.024,0.013,0.004,-0.008,-0.027,-0.055,-0.084,-0.093,-0.061,-0.036,-0.002,0.033,0.037,-0.014,-0.045,-0.103,-0.077,-0.023,0.031,0.041,0.026,0.013,0.015,0.061,0.073,0.074,0.076,0.073,0.071,0.057,0.038,0.021,-0.002,-0.033,-0.064,-0.068,-0.051,-0.054,-0.054,-0.057,-0.033,0,0.033,0.07,0.096,0.085,0.08,0.068,0.075,0.077,0.085,0.061,0.037,0.007,-0.001,0.004,0.005,-0.01,-0.029,-0.046,-0.069,-0.065,-0.044,-0.028,-0.007,-0.023,-0.033,-0.051,-0.06,-0.056,-0.054,-0.05,-0.066,-0.091,-0.114,-0.14,-0.138,-0.14,-0.121,-0.096,-0.074,-0.046,-0.034,-0.042,-0.045,-0.055,-0.063,-0.072,-0.08,-0.073,-0.052,-0.037,-0.026,-0.014
    </textarea></p>
    <p>
    <h3>描画オプション</h3>
    <select id="vel">
    <option value=10>超高速</option>
    <option value=100>高速</option>
    <option value=1000 selected>普通</option>
　　<option value=3000>低速</option>
　　<option value=10000>とてもゆっくり</option>
    </select>
    <input type="radio" name ="rotate_on" value=0>回転ON &nbsp;&nbsp;
    <input type="radio" name ="rotate_on" value=1 checked>回転OFF
    </p>

    <p>
    <button id="review" onclick="webGLStart()">描画開始</button><br>
    <button id="review" onclick="webGLStop()">描画停止</button><br>

    <canvas id="lesson03-canvas" style="border: none;" width="1000" height="200"></canvas>
    <!-- CanvasはHTML 5.0のための新しいタグ　ここでは<canvas>タグではレイアウトを調整する簡単な属性以外は指定されていない。
	 WebGLのJavaScriptのセットアップはページが読み込まれたときに一度だけ呼ばれるwebGLStart関数から呼び出されている。 
    -->
    <br/>
</body>

</html>
